<template>
  <p class="desc" id="textboxPopup"></p>
  <div class="button-container">
    <button v-if="showStartButton" @click="startGame()">å¼€å§‹æ¸¸æˆ</button>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { useStore } from 'vuex'

import { showStartGameDialog } from '../components/composables/gameRefs'

const store = useStore()
const showStartButton = ref(false)
onMounted(async () => {
  if (document.getElementById('textboxPopup')) {
    await store.dispatch('typeWriterPopup', ['ã€ç³»ç»Ÿã€‘è¿™æ˜¯ä¸€ä¸ªå…­æœˆçš„å¤å¤©ï¼Œä½ çå¼€äº†ä½ çš„å¤§çœ¼ç›ğŸ¥ºï¼Œä½ æƒŠå‘†äº†ï¼å› ä¸ºä½ é‡ç”Ÿäº†â€¦â€¦', 'ã€ç³»ç»Ÿã€‘ä½ é‡ç”Ÿæˆäº†å§œäº‘å‡ï¼', 'ã€ç³»ç»Ÿã€‘ä½ å†³å®šâ€”â€”'])
    await new Promise(resolve => setTimeout(resolve, 200))
    showStartButton.value = true
  }
});

const startGame = async () => {
  showStartGameDialog.value = false
  await store.dispatch('typeWriter', 'ã€ç³»ç»Ÿã€‘ä½ é€‰æ‹©äº†å¼€å§‹æ¸¸æˆï¼')
  await new Promise(resolve => setTimeout(resolve, 200))
  await store.dispatch('typeWriter', 'ã€ç³»ç»Ÿã€‘ä½ å“­å¾—å¾ˆå¤§å£°ï¼')
  await new Promise(resolve => setTimeout(resolve, 200))
  await store.dispatch('typeWriter', 'ã€ç³»ç»Ÿã€‘ä½ å“­ä½ çš„æ‡µæ‡‚å‡ºç”Ÿï¼Œä½ å“­ä½ çš„å‰é€”æœªåœï¼Œè¿™ä¸€ä¸–ï¼Œä½ è¦å·åœŸé‡æ¥ï¼Œä½ è·å¾—äº†åˆå§‹å±æ€§ï¼šã€è™šå¼±ã€‘')
  await new Promise(resolve => setTimeout(resolve, 1000))
  await store.dispatch('typeWriter', 'ã€ç³»ç»Ÿã€‘ä½ å“­å¾—æ›´å¤§å£°äº†ï¼')
  await new Promise(resolve => setTimeout(resolve, 200))
  await store.dispatch('typeWriter', 'ã€ç³»ç»Ÿã€‘ç»ˆäºåˆ°äº†15å²ï¼Œä½ é•¿æˆäº†é£ä¸€æ ·çš„å°‘å¹´ï¼Œè¿™ä¸€å¤©ï¼Œä½ å†³å®šå»â€”â€”')
}

</script>

<style scoped>
.button-container {
  margin: 0.25rem auto;
  gap: 0.25rem;
  display: flex;
  justify-content: center;
  align-items: center;
}

.button-container button {
  padding: 0.4rem 1rem;
  border: 2px solid #1e2228;
  background-color: #9d4842;
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
  white-space: nowrap;
}
</style>
